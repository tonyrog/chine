%% -*- erlang -*-
%% test of CHI program
%%
{export, run}.

{import, "io"}.

{function, [], run, [], [t0,t1,f],
 [
  {op,':=',t0, now},
  {op,':=',f,{call, fib, [17]}},
  {op,':=',t1, now},
  {call,puts,[{string,"fibonacci(17)="}]},
  {call,println,[f]},
  {call,puts,[{string,"time="}]},
  {call,print,[{op,'-',t1,t0}]}, 
  {call,puts,[{string,"ms\n"}]},
  terminate
 ]}.

{function, [int], fib, [n], [],
 [
  {'if', {op,'==',n,0}, 0,
   {'if', {op,'==',n,1}, 1,
    {op,'+',
     {call,fib,[{op,'-',n,1}]},
     {call,fib,[{op,'-',n,2}]}}}}
 ]}.
